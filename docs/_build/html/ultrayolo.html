

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ultrayolo package &mdash; ultrayolo 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ultrayolo.datasets package" href="ultrayolo.datasets.html" />
    <link rel="prev" title="ultrayolo" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ultrayolo
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">ultrayolo</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="train.html">Training</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">ultrayolo</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ultrayolo package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ultrayolo.datasets.html">ultrayolo.datasets package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ultrayolo.helpers.html">ultrayolo.helpers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="ultrayolo.layers.html">ultrayolo.layers package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ultrayolo.cli">ultrayolo.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ultrayolo.learningrates">ultrayolo.learningrates module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ultrayolo.losses">ultrayolo.losses module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ultrayolo.ultrayolo">ultrayolo.ultrayolo module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ultrayolo">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/1_predict_yolo_model.html">Predict using default Yolo Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/2_predict_custom_model.html">Predict using a custom Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/3_check_yolo_loss.html">Yolo Loss Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/4_train_example.html">Sample to train Yolo for object detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/4_train_example.html#Evaluate-model-Loss">Evaluate model Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/5_data_augmentation_howto.html">Data Augmentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ultrayolo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">ultrayolo</a> &raquo;</li>
        
      <li>ultrayolo package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ultrayolo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="ultrayolo-package">
<h1>ultrayolo package<a class="headerlink" href="#ultrayolo-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ultrayolo.datasets.html">ultrayolo.datasets package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.datasets.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.datasets.html#module-ultrayolo.datasets.common">ultrayolo.datasets.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.datasets.html#module-ultrayolo.datasets.datasets">ultrayolo.datasets.datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.datasets.html#module-ultrayolo.datasets.genanchors">ultrayolo.datasets.genanchors module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.datasets.html#module-ultrayolo.datasets">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ultrayolo.helpers.html">ultrayolo.helpers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.helpers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.helpers.html#module-ultrayolo.helpers.callbacks">ultrayolo.helpers.callbacks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.helpers.html#module-ultrayolo.helpers.darknet">ultrayolo.helpers.darknet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.helpers.html#module-ultrayolo.helpers.draw">ultrayolo.helpers.draw module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.helpers.html#module-ultrayolo.helpers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ultrayolo.layers.html">ultrayolo.layers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.layers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.layers.html#module-ultrayolo.layers.core">ultrayolo.layers.core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ultrayolo.layers.html#module-ultrayolo.layers">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ultrayolo.cli">
<span id="ultrayolo-cli-module"></span><h2>ultrayolo.cli module<a class="headerlink" href="#module-ultrayolo.cli" title="Permalink to this headline">¶</a></h2>
<p>Console script for ultrayolo.</p>
<dl class="function">
<dt id="ultrayolo.cli.load_anchors">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">load_anchors</code><span class="sig-paren">(</span><em>mode</em>, <em>number</em>, <em>path</em>, <em>ds_mode</em>, <em>ds_train_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#load_anchors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.load_anchors" title="Permalink to this definition">¶</a></dt>
<dd><p>load or compute the anchors given a dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{str} -- siniglefile</strong><strong>, </strong><strong>multifile</strong><strong>, </strong><strong>coco</strong> (<em>mode</em>) – </li>
<li><strong>{int} -- the number of anchors</strong> (<em>number</em>) – </li>
<li><strong>{str} -- the path to the anchors</strong> (<em>path</em>) – </li>
<li><strong>{str} -- the mode of the dataset</strong> (<em>ds_mode</em>) – </li>
<li><strong>{str} -- the path to the dataset</strong> (<em>ds_train_path</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">np.ndarray – the anchors for the algorithm</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ultrayolo.cli.load_config">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">load_config</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#load_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.load_config" title="Permalink to this definition">¶</a></dt>
<dd><p>load config from yaml</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>{str} -- the path of the yaml file</strong> (<em>path</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">object – an object with the given configurations</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ultrayolo.cli.load_datasets">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">load_datasets</code><span class="sig-paren">(</span><em>mode</em>, <em>image_shape</em>, <em>anchors</em>, <em>train_path</em>, <em>val_path</em>, <em>augment</em>, <em>max_objects</em>, <em>batch_size</em>, <em>pad_to_fixed_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#load_datasets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.load_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>load a dataset from configs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>{object} -- the configutations</strong> (<em>ds_conf</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tuple – train and test dataset tf.keras.Sequence objects</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ultrayolo.cli.load_model">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>num_masks</em>, <em>dataset</em>, <em>iou</em>, <em>object_score</em>, <em>backbone</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.load_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ultrayolo.cli.main">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">main</code><span class="sig-paren">(</span><em>dataset</em>, <em>model</em>, <em>fit</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.main" title="Permalink to this definition">¶</a></dt>
<dd><p>the main to train the algorithm</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>{object} -- the configurations to run the algorithm</strong> (<em>config</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ultrayolo.cli.make_augmentations">
<code class="descclassname">ultrayolo.cli.</code><code class="descname">make_augmentations</code><span class="sig-paren">(</span><em>max_number_augs=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/cli.html#make_augmentations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.cli.make_augmentations" title="Permalink to this definition">¶</a></dt>
<dd><p>apply data augmentations to the dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><strong>{int} -- the max number of augmentation to apply to each image</strong><strong> (</strong><strong>default</strong> (<em>max_number_augs</em>) – {5})</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">[type] – [description]</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ultrayolo.learningrates">
<span id="ultrayolo-learningrates-module"></span><h2>ultrayolo.learningrates module<a class="headerlink" href="#module-ultrayolo.learningrates" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ultrayolo.learningrates.cyclic_learning_rate">
<code class="descclassname">ultrayolo.learningrates.</code><code class="descname">cyclic_learning_rate</code><span class="sig-paren">(</span><em>learning_rate=0.01</em>, <em>max_lr=0.1</em>, <em>step_size=20.0</em>, <em>gamma=0.99994</em>, <em>mode='triangular'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/learningrates.html#cyclic_learning_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.learningrates.cyclic_learning_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cyclic learning rate (CLR).
From the paper:
Smith, Leslie N. “Cyclical learning
rates for training neural networks.” 2017.
[<a class="reference external" href="https://arxiv.org/pdf/1506.01186.pdf">https://arxiv.org/pdf/1506.01186.pdf</a>]</p>
<blockquote>
<div>This method lets the learning rate cyclically</div></blockquote>
<p>vary between reasonable boundary values
achieving improved classification accuracy and
often in fewer iterations.</p>
<blockquote>
<div>This code varies the learning rate linearly between the</div></blockquote>
<dl class="docutils">
<dt>minimum (learning_rate) and the maximum (max_lr).</dt>
<dd><dl class="first docutils">
<dt>It returns the cyclic learning rate. It is computed as:</dt>
<dd><p class="first"><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
cycle = floor( 1 + global_step /</p>
<blockquote class="last">
<div>( 2 * step_size ) )</div></blockquote>
</dd>
</dl>
<p>x = abs( global_step / step_size – 2 * cycle + 1 )
clr = learning_rate +</p>
<blockquote>
<div><blockquote>
<div>( max_lr – learning_rate ) * max( 0 , 1 - x )</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
</div></blockquote>
<dl class="last docutils">
<dt>Polices:</dt>
<dd><dl class="first last docutils">
<dt>‘triangular’:</dt>
<dd><blockquote class="first">
<div>Default, linearly increasing then linearly decreasing the
learning rate at each cycle.</div></blockquote>
<dl class="last docutils">
<dt>‘triangular2’:</dt>
<dd>The same as the triangular policy except the learning
rate difference is cut in half at the end of each cycle.
This means the learning rate difference drops after each cycle.</dd>
<dt>‘exp_range’:</dt>
<dd>The learning rate varies between the minimum and maximum
boundaries and each boundary value declines by an exponential
factor of: gamma^global_step.</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ultrayolo.learningrates.default_decay">
<code class="descclassname">ultrayolo.learningrates.</code><code class="descname">default_decay</code><span class="sig-paren">(</span><em>num_epochs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/learningrates.html#default_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.learningrates.default_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ultrayolo.losses">
<span id="ultrayolo-losses-module"></span><h2>ultrayolo.losses module<a class="headerlink" href="#module-ultrayolo.losses" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ultrayolo.losses.Loss">
<em class="property">class </em><code class="descclassname">ultrayolo.losses.</code><code class="descname">Loss</code><span class="sig-paren">(</span><em>anchor_masks</em>, <em>ignore_iou_threshold</em>, <em>img_size</em>, <em>num_classes</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/losses.html#Loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.losses.Loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="staticmethod">
<dt id="ultrayolo.losses.Loss.broadcast_iou">
<em class="property">static </em><code class="descname">broadcast_iou</code><span class="sig-paren">(</span><em>box_1</em>, <em>box_2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/losses.html#Loss.broadcast_iou"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.losses.Loss.broadcast_iou" title="Permalink to this definition">¶</a></dt>
<dd><p>brodcast intersection over union</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{tf.tensor} --</strong> (<em>box_2</em>) – </li>
<li><strong>{tf.tensor} --</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tf.tensor  – intersection over union</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ultrayolo.losses.make_loss">
<code class="descclassname">ultrayolo.losses.</code><code class="descname">make_loss</code><span class="sig-paren">(</span><em>num_classes</em>, <em>anchors</em>, <em>masks</em>, <em>img_size</em>, <em>ignore_iou_threshold=0.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/losses.html#make_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.losses.make_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>the default Yolo Loss</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{int} -- the number of classes</strong> (<em>num_classes</em>) – </li>
<li><strong>{tf.tensor} -- the anchors used to train the model</strong> (<em>anchors</em>) – </li>
<li><strong>{tf.tensor} -- the masks used select the anchors</strong> (<em>masks</em>) – </li>
<li><strong>{int} -- the size of the image</strong> (<em>img_size</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first"><strong>{float} -- the value below of which do not consider the predictions</strong><strong> (</strong><strong>default</strong> (<em>ignore_iou_threshold</em>) – {0.7})</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">function  – a function that compute the loss</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="ultrayolo.losses.process_predictions">
<code class="descclassname">ultrayolo.losses.</code><code class="descname">process_predictions</code><a class="reference internal" href="_modules/ultrayolo/losses.html#process_predictions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.losses.process_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>process the predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{tf.tensor} -- the predictions</strong> (<em>y_pred</em>) – </li>
<li><strong>{int} -- the number of classes</strong> (<em>num_classes</em>) – </li>
<li><strong>{tf.tensor} -- the anchors masks</strong> (<em>anchors_masks</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple – box_xyxy, pred_obj, pred_class, pred_xywh</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="ultrayolo.losses.to_box_xyxy">
<code class="descclassname">ultrayolo.losses.</code><code class="descname">to_box_xyxy</code><a class="reference internal" href="_modules/ultrayolo/losses.html#to_box_xyxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.losses.to_box_xyxy" title="Permalink to this definition">¶</a></dt>
<dd><p>convert the given boxes into the xy_min xy_max format
:param box_xy {tf.tensor} –:
:param box_wh {tf,tensor} –:
:param grid_size {float} – the size of the grid used:
:param anchors_masks {tf.tensor} – the anchor masks:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tf.tensor – the boxes</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ultrayolo.ultrayolo">
<span id="ultrayolo-ultrayolo-module"></span><h2>ultrayolo.ultrayolo module<a class="headerlink" href="#module-ultrayolo.ultrayolo" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ultrayolo.ultrayolo.BaseModel">
<em class="property">class </em><code class="descclassname">ultrayolo.ultrayolo.</code><code class="descname">BaseModel</code><span class="sig-paren">(</span><em>img_shape=(None</em>, <em>None</em>, <em>3)</em>, <em>max_objects=100</em>, <em>iou_threshold=0.7</em>, <em>score_threshold=0.7</em>, <em>anchors=None</em>, <em>num_classes=80</em>, <em>training=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.compile">
<code class="descname">compile</code><span class="sig-paren">(</span><em>optimizer</em>, <em>loss</em>, <em>run_eagerly</em>, <em>summary=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.compile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>compile the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{tf.keras.optimizers} -- a valid tensorflow optimizer</strong> (<em>optimizer</em>) – </li>
<li><strong>{ultrayolo.losses.Loss} -- the loss function for yolo</strong> (<em>loss</em>) – </li>
<li><strong>{bool} -- if True is uses eager mode</strong><strong>, </strong><strong>that is you can see more explainable stack traces</strong> (<em>run_eagerly</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>{bool} -- if True print the summary of the model</strong><strong> (</strong><strong>default</strong> (<a class="reference internal" href="#ultrayolo.ultrayolo.BaseModel.summary" title="ultrayolo.ultrayolo.BaseModel.summary"><em>summary</em></a>) – {True})</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>train_dataset</em>, <em>val_dataset</em>, <em>epochs</em>, <em>initial_epoch=0</em>, <em>callbacks=None</em>, <em>workers=1</em>, <em>max_queue_size=64</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>train the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{ultrayolo.datasets.Dataset} -- an instance of the dataset</strong> (<em>val_dataset</em>) – </li>
<li><strong>{ultrayolo.datasets.Dataset} -- an instance of the dataset</strong> – </li>
<li><strong>{int} -- the number of epochs</strong> (<em>epochs</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>{int} -- the inital epoch</strong><strong> (</strong><strong>default</strong> (<em>initial_epoch</em>) – {0})</li>
<li><strong>{</strong><strong>[</strong><strong>type</strong><strong>]</strong><strong>} -- a list of callbacks for the model</strong><strong> (</strong><strong>default</strong> (<a class="reference internal" href="ultrayolo.helpers.html#module-ultrayolo.helpers.callbacks" title="ultrayolo.helpers.callbacks"><em>callbacks</em></a>) – {None})</li>
<li><strong>{int} -- the number of workers</strong><strong> (</strong><strong>default</strong> (<em>workers</em>) – {1})</li>
<li><strong>{int} -- the max size of the queue</strong><strong> (</strong><strong>default</strong> (<em>max_queue_size</em>) – {64})</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">[type] – [description]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.get_loss_function">
<code class="descname">get_loss_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.get_loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.get_loss_function" title="Permalink to this definition">¶</a></dt>
<dd><p>singleton for the yolo loss function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list – a list of the loss function for each mask</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.get_optimizer">
<code class="descname">get_optimizer</code><span class="sig-paren">(</span><em>optimizer_name</em>, <em>lrate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.get_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.get_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>helper to create the optimizer using the class defined members</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{str} -- the name of the optimizer to use</strong> (<em>optimizer_name</em>) – (values: adam, rmsprop, sgd)</li>
<li><strong>{float} -- a valid starting value for the learning rate</strong> (<em>lrate</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Exception</span></code> – raise an exception if the optimizer is not supported</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensorflow.keras.optimizer – an instance of the selected optimizer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.load_weights">
<code class="descname">load_weights</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.load_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.load_weights" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>load:</dt>
<dd><ul class="first last simple">
<li>saved checkpoints in h5 format</li>
<li>saved weights in darknet format</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>{str} -- the path where the weights are saved</strong> (<em>path</em>) – </li>
<li><strong>{str} -- the name of the backbone used</strong> (<em>backbone</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>path</em>, <em>save_format='h5'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>save the model to the given path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>{str|pathlib.Path} -- the path to save the checkpoint</strong> (<em>path</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.set_mode_fine_tuning">
<code class="descname">set_mode_fine_tuning</code><span class="sig-paren">(</span><em>num_layers_to_train</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.set_mode_fine_tuning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.set_mode_fine_tuning" title="Permalink to this definition">¶</a></dt>
<dd><p>unfreeze the backbone and freeze the first <cite>num_layers_to_train</cite> layers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>{</strong><strong>[</strong><strong>type</strong><strong>]</strong><strong>} --</strong><strong> [</strong><strong>description</strong><strong>]</strong> (<em>num_layers_to_train</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.set_mode_train">
<code class="descname">set_mode_train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.set_mode_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.set_mode_train" title="Permalink to this definition">¶</a></dt>
<dd><p>unfreeze all the net read for a full training</p>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.set_mode_transfer">
<code class="descname">set_mode_transfer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.set_mode_transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.set_mode_transfer" title="Permalink to this definition">¶</a></dt>
<dd><p>freeze the backbone of the network, check that the head and output layers are unfreezed</p>
</dd></dl>

<dl class="method">
<dt id="ultrayolo.ultrayolo.BaseModel.summary">
<code class="descname">summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#BaseModel.summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.BaseModel.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>return the tensorflow model summary</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ultrayolo.ultrayolo.YoloV3">
<em class="property">class </em><code class="descclassname">ultrayolo.ultrayolo.</code><code class="descname">YoloV3</code><span class="sig-paren">(</span><em>img_shape=(None</em>, <em>None</em>, <em>3)</em>, <em>max_objects=100</em>, <em>iou_threshold=0.5</em>, <em>score_threshold=0.7</em>, <em>anchors=None</em>, <em>num_classes=80</em>, <em>training=False</em>, <em>backbone='DarkNet'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#YoloV3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ultrayolo.ultrayolo.BaseModel" title="ultrayolo.ultrayolo.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ultrayolo.ultrayolo.BaseModel</span></code></a></p>
<dl class="attribute">
<dt id="ultrayolo.ultrayolo.YoloV3.default_anchors">
<code class="descname">default_anchors</code><em class="property"> = array([[ 10.,  13.],        [ 16.,  30.],        [ 33.,  23.],        [ 30.,  61.],        [ 62.,  45.],        [ 59., 119.],        [116.,  90.],        [156., 198.],        [373., 326.]], dtype=float32)</em><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3.default_anchors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ultrayolo.ultrayolo.YoloV3.default_masks">
<code class="descname">default_masks</code><em class="property"> = array([[6, 7, 8],        [3, 4, 5],        [0, 1, 2]])</em><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3.default_masks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ultrayolo.ultrayolo.YoloV3Tiny">
<em class="property">class </em><code class="descclassname">ultrayolo.ultrayolo.</code><code class="descname">YoloV3Tiny</code><span class="sig-paren">(</span><em>img_shape=(None</em>, <em>None</em>, <em>3)</em>, <em>max_objects=100</em>, <em>iou_threshold=0.7</em>, <em>score_threshold=0.7</em>, <em>anchors=None</em>, <em>num_classes=80</em>, <em>training=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#YoloV3Tiny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3Tiny" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ultrayolo.ultrayolo.BaseModel" title="ultrayolo.ultrayolo.BaseModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ultrayolo.ultrayolo.BaseModel</span></code></a></p>
<dl class="attribute">
<dt id="ultrayolo.ultrayolo.YoloV3Tiny.default_anchors">
<code class="descname">default_anchors</code><em class="property"> = array([[ 10.,  14.],        [ 23.,  27.],        [ 37.,  58.],        [ 81.,  82.],        [135., 169.],        [344., 319.]], dtype=float32)</em><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3Tiny.default_anchors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ultrayolo.ultrayolo.YoloV3Tiny.default_masks">
<code class="descname">default_masks</code><em class="property"> = array([[3, 4, 5],        [0, 1, 2]])</em><a class="headerlink" href="#ultrayolo.ultrayolo.YoloV3Tiny.default_masks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="ultrayolo.ultrayolo.non_max_suppression">
<code class="descclassname">ultrayolo.ultrayolo.</code><code class="descname">non_max_suppression</code><a class="reference internal" href="_modules/ultrayolo/ultrayolo.html#non_max_suppression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ultrayolo.ultrayolo.non_max_suppression" title="Permalink to this definition">¶</a></dt>
<dd><p>an implementation of non max suppression</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>{tf.tensor} -- the outputs of the yolo branches</strong> (<em>outputs</em>) – </li>
<li><strong>{np.ndarray} -- the anchors scaled in</strong><strong> [</strong><strong>0</strong><strong>,</strong><strong>1</strong><strong>]</strong> (<em>anchors</em>) – </li>
<li><strong>{np.ndarray} -- the list of the anchors to use</strong> (<em>masks</em>) – </li>
<li><strong>{list} -- the list of classes</strong> (<em>classes</em>) – </li>
<li><strong>{float} -- the minimum intersection over union threshold</strong> (<em>iou_threshold</em>) – </li>
<li><strong>{float} -- the minimum confidence score to use</strong> (<em>score_threshold</em>) – </li>
<li><strong>{int} -- the number of maximum boxes to show</strong> (<em>max_boxes_per_image</em>) – </li>
<li><strong>{int} -- the size of the image</strong> (<em>img_size</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(boxes, scores, classes, valid_detections) – a tuple of the results</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ultrayolo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ultrayolo" title="Permalink to this headline">¶</a></h2>
<p>Top-level package for ultrayolo.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ultrayolo.datasets.html" class="btn btn-neutral float-right" title="ultrayolo.datasets package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="ultrayolo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Fabio Fumarola

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>